---
version: '2'
services:
  nginx:
    image: nginx:1.21.6-alpine
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/configs/:/etc/nginx/conf.d/:ro
    ports:
      - 8000:8888
    depends_on:
      - ugcapp

  ugcapp:
    build:
      context: ..
      dockerfile: docker/dockerfiles/UgcAppDockerfile
      target: prod
    env_file: envs/prod.env
    depends_on:
      broker:
        condition: service_healthy
